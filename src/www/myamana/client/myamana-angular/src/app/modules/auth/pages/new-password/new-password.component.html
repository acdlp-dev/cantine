@if(!isPwdChanged){
  <form (ngSubmit)="onSubmit()" class="my-10 space-y-6">
    <div class="relative">
      <label for="new-password" class="block mb-2 text-sm font-medium text-gray-700">Nouveau mot de passe</label>
      <div class="relative">
        <input
          [type]="passwordTextType ? 'text' : 'password'"
          id="new-password"
          [(ngModel)]="newPassword"
          name="newPassword"
          required
          class="peer block w-full pr-10 rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-primary focus:outline-none focus:ring-primary"
          placeholder="Entrez votre nouveau mot de passe"
          (input)="updatePasswordStrength(newPassword)"
        />
        <span class="absolute inset-y-0 right-3 flex items-center cursor-pointer text-gray-600" (click)="togglePasswordTextType()">
          <svg-icon
            [src]="passwordTextType ? 'assets/icons/heroicons/outline/eye.svg' : 'assets/icons/heroicons/outline/eye-off.svg'"
            [svgClass]="'h-5 w-5'">
          </svg-icon>
        </span>
      </div>
    </div>

    <!-- Barres de force -->
    <div class="grid grid-cols-4 gap-2 mt-2">
      <div *ngFor="let i of [1, 2, 3, 4]; let index = index" class="h-1 rounded-sm" [ngClass]="{
              'bg-primary': passwordStrength > index,
              'bg-muted': passwordStrength <= index
            }"></div>
    </div>
    <ul class="text-xs text-muted-foreground mt-1">
      <li [ngClass]="{ 'text-primary': hasMinLength }">Au moins 8 caractères</li>
      <li [ngClass]="{ 'text-primary': hasLetter }">Au moins une lettre</li>
      <li [ngClass]="{ 'text-primary': hasNumber }">Au moins un chiffre</li>
      <li [ngClass]="{ 'text-primary': hasSpecialChar }">Au moins un symbole (&#64;, $, !, %, etc.)</li>
    </ul>

    <div class="relative mt-4">
      <label for="confirm-password" class="block mb-2 text-sm font-medium text-gray-700">Confirmez le mot de passe</label>
      <input
        type="password"
        id="confirm-password"
        [(ngModel)]="confirmPassword"
        name="confirmPassword"
        required
        class="peer block w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-primary focus:outline-none focus:ring-primary"
        placeholder="Confirmez votre nouveau mot de passe"
      />
    </div>

    <!-- Messages d'erreur -->
    <div *ngIf="submitted && newPassword !== confirmPassword" class="text-xs text-red-500">
      Les mots de passe ne correspondent pas.
    </div>
    <div *ngIf="submitted && !isPasswordValid()" class="text-xs text-red-500">
      Le mot de passe doit respecter les règles ci-dessus.
    </div>

    <div style="margin-top: 20px;">
      <app-button full impact="bold" tone="primary" shape="rounded" size="medium" type="submit">Réinitialiser</app-button>
    </div>
  </form>
} @else {
  <div class="text-center">
    <h2 class="mb-4 text-xl font-bold text-gray-800">Votre mot de passe a été réinitialisé avec succès !</h2>
    <p class="text-sm text-gray-600">
      <a [routerLink]="getRedirectLink()" class="text-primary font-semibold hover:underline">Cliquez ici pour vous connecter</a>.
    </p>
  </div>}
