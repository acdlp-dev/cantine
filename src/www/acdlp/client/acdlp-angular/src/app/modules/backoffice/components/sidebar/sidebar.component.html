<!-- Bouton hamburger pour mobile - visible uniquement sur petit écran -->
<button (click)="toggleSidebar()"
  class="md:hidden fixed top-4 left-4 z-50 p-2 rounded-md bg-white shadow-md border border-gray-200 focus:outline-none">
  <i-lucide name="menu" class="w-6 h-6 text-[#ff8a66]"></i-lucide>
</button>

<!-- Overlay sombre qui apparaît derrière la sidebar sur mobile -->
<div *ngIf="isSidebarOpen" class="md:hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-40 transition-opacity"
  (click)="toggleSidebar()"></div>

<!-- Sidebar responsive -->
<aside [ngClass]="{'translate-x-0': isSidebarOpen, '-translate-x-full': !isSidebarOpen, 'md:translate-x-0': true}"
  class="w-64 h-screen bg-white border-r border-gray-200 fixed left-0 top-0 overflow-y-auto z-40 transition-transform duration-300 ease-in-out">

  <div class="p-6 flex items-center justify-between">
    <h2 class="text-xl font-bold text-[#ff8a66]">MyAmana</h2>
    <!-- Bouton fermer pour mobile -->
    <button (click)="toggleSidebar()" class="md:hidden p-1 rounded hover:bg-[#fff8f6]">
      <i-lucide name="x" class="w-5 h-5 text-gray-500"></i-lucide>
    </button>
  </div>

  <nav class="mt-2 px-3 space-y-4 sidebar-container">
    <ng-container *ngFor="let section of sections">
      <div *ngIf="section.items && section.items.length" class="mb-1">
        <button (click)="toggleSection(section.key)" class="w-full flex items-center justify-between px-3 mb-2">
          <h3 class="text-xs font-semibold uppercase text-gray-400">{{ section.label }}</h3>
          <i-lucide name="chevron-down" class="w-4 h-4 text-gray-400" [ngClass]="{'rotate-180': openSections[section.key]}" />
        </button>
        <div class="space-y-1" *ngIf="openSections[section.key] !== false">
          <ng-container *ngFor="let tab of section.items">
            <!-- Lien externe -->
            <a *ngIf="tab.key !== 'logout' && tab.route.startsWith('http')" 
               [href]="tab.route" 
               target="_blank"
               class="flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors w-full text-left text-gray-600 hover:text-[#ff8a66] hover:bg-[#fff8f6]"
               (click)="closeSidebarOnMobile()">
              <i-lucide [name]="tab.icon" class="mr-3 w-5 h-5"></i-lucide>
              <span class="flex-1">{{ tab.label }}</span>
            </a>

            <!-- Lien interne -->
            <a *ngIf="tab.key !== 'logout' && !tab.route.startsWith('http')" 
               [routerLink]="[tab.route]"
              [ngClass]="{
                'bg-[#fff1ec] text-[#ff8a66]': isActiveTab(tab.key),
                'text-gray-600': !isActiveTab(tab.key)
              }"
              class="flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors w-full text-left hover:text-[#ff8a66] hover:bg-[#fff8f6]"
              (click)="closeSidebarOnMobile()">
              <i-lucide [name]="tab.icon" class="mr-3 w-5 h-5"
                [ngClass]="{'text-[#ffab91]': isActiveTab(tab.key)}"></i-lucide>
              <span class="flex-1">{{ tab.label }}</span>
            </a>

            <button *ngIf="tab.key === 'logout'" (click)="onLogout()"
              class="flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors w-full text-left text-gray-600 hover:text-[#ff8a66] hover:bg-[#fff8f6]">
              <i-lucide [name]="tab.icon" class="mr-3 w-5 h-5"></i-lucide>
              <span class="flex-1">{{ tab.label }}</span>
            </button>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </nav>

  <div class="p-4 border-t border-gray-200 mb-16">
    <div class="flex items-center px-3 py-2 text-sm text-gray-700">
      <div class="w-8 h-8 rounded-full bg-[#fff1ec] flex items-center justify-center mr-3">
        <span class="text-[#ff8a66] font-medium">{{ getInitials() }}</span>
      </div>
      <div>
        <p class="font-medium">MyAmana</p>
        <p class="text-xs text-gray-500">Nom de l'utilisateur</p>
      </div>
    </div>
  </div>
</aside>

<!-- Espace réservé pour le contenu principal - ajout d'une marge à gauche uniquement sur desktop -->
<div class="md:ml-64 transition-all duration-300"></div>
